/* Import Tailwind v4 */
@import "tailwindcss";

/* ---------- Design tokens (Tailwind v4 @theme) ---------- */
/* Colors are defined as OKLCH to keep good contrast across light/dark */

@theme {
  /* Font & radius */
  --font-sans: "Creato", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  --radius-sm: 0.25rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.75rem;

  /* Base surfaces */
  --color-background: oklch(0.98 0.01 240);
  --color-foreground: oklch(0.23 0.03 240);

  --color-surface: oklch(0.99 0.005 240);
  --color-muted: oklch(0.95 0.02 240);
  --color-muted-foreground: oklch(0.47 0.03 240);

  --color-border: oklch(0.88 0.02 240);
  --color-ring: oklch(0.6 0.08 250);

  /* Brand & semantic */
  --color-primary: oklch(0.55 0.14 260);
  --color-primary-foreground: oklch(0.98 0.01 240);

  --color-success: oklch(0.66 0.13 150);
  --color-warning: oklch(0.82 0.15 95);
  --color-danger:  oklch(0.56 0.20 20);

  /* Card / elevated */
  --shadow-card: 0 6px 14px -6px rgb(0 0 0 / 0.15);
}

/* Dark theme tokens override */

@theme .dark {
  --color-background: oklch(0.25 0.005 100);
  --color-foreground: oklch(0.96 0.01 240);

  --color-surface: oklch(0.18 0.02 240);
  --color-muted: oklch(0.23 0.02 240);
  --color-muted-foreground: oklch(0.75 0.02 240);

  --color-border: oklch(0.32 0.02 240);
  --color-ring: oklch(0.75 0.06 250);

  --color-primary: oklch(0.4745 0.3 200);
  --color-primary-foreground: oklch(0.96 0.02 240);

  --color-secondary: oklch(0.3264 0.0045 67.67);
  --color-secondary-foreground: oklch(0.95 0.01 240);

  --color-tertiary: oklch(0.45 0 0);
  --color-tertiary-foreground: oklch(0.95 0.01 240);

  --color-success: oklch(0.80 0.13 150);
  --color-warning: oklch(0.86 0.15 95);
  --color-danger:  oklch(0.6649 0.1894 30.36);

  --shadow-card: 0 8px 20px -8px rgb(0 0 0 / 0.45);
}

/* ---------- Fonts ---------- */

@font-face {
  font-family: 'ChettaVissto';
  src: url('../fonts/ChettaVissto.otf') format('opentype');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: 'Creato';
  src: url('../fonts/CreatoDisplay-Regular.otf') format('opentype');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: 'Creato';
  src: url('../fonts/CreatoDisplay-Bold.otf') format('opentype');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

/* ---------- Base styles ---------- */

* {
  box-sizing: border-box;
  letter-spacing: 0.04rem;
}

:root {
  /* Respect system theme on first load (optional).
     You can remove this if you force .dark via app state. */
  color-scheme: light dark;
}

html, body, #app {
  height: 100%;
}

body {
  /* Use tokens via Tailwind color names defined in @theme */
  @apply text-xs bg-background text-foreground;
  font-family: var(--font-sans), sans-serif;
}

/* Typography scale (minimal) */

h2 {
  @apply text-xl font-bold;
}
h3 {
  @apply text-sm font-bold;
}
hr {
  @apply border-border my-3;
}

/* Form elements */

input {
  @apply h-8 px-2 border border-background bg-surface text-foreground rounded-sm outline-0
  focus-visible:ring-2 ring-ring bg-tertiary;
}
textarea {
  @apply w-full p-2 border border-border rounded-md bg-surface text-foreground outline-0
  focus-visible:ring-2 ring-ring;
}

/* ---------- Component-level utilities (small, composable) ---------- */

/* Buttons */

@utility btn {
  @apply inline-flex items-center justify-center gap-2 font-bold rounded-sm border
  px-4 py-2 cursor-pointer select-none h-8
  focus-visible:outline-none focus-visible:ring-2 ring-ring
  disabled:opacity-30 disabled:cursor-not-allowed;
  font-family: var(--font-sans), sans-serif;
}
@utility btn-sm {
  @apply px-2 py-1 text-xs;
}
@utility btn-lg {
  @apply px-5 py-2.5 text-sm;
}

@utility btn-neutral {
  @apply bg-tertiary text-foreground border-muted hover:bg-muted/80 hover:border-muted/80;
}
@utility btn-primary {
  @apply bg-primary text-primary-foreground border-primary hover:bg-primary/90 hover:border-primary/90;
}
@utility btn-danger {
  @apply bg-danger border-danger hover:bg-danger/90 hover:border-danger/90;
}

@utility feed-element {
  @apply p-4 drop-shadow-md rounded-lg bg-secondary;
}

@utility dictation-text {
  @apply p-2 rounded-sm bg-tertiary/50 whitespace-pre-wrap;
}

/* Legacy compatibility: keep your existing class names working */

/*button.small-action {*/
/*  @apply btn btn-sm;*/
/*}*/
/*button.action {*/
/*  @apply btn;*/
/*}*/
/*button.neutral {*/
/*  @apply btn-neutral;*/
/*}*/
/*button.primary {*/
/*  @apply btn-primary;*/
/*}*/
/*button.danger  {*/
/*  @apply btn-danger;*/
/*}*/
/*button:disabled {*/
/*  @apply disabled:opacity-30 disabled:cursor-not-allowed disabled:border-border;*/
/*}*/

/* Dictation cards */
.dictation {
  @apply bg-surface rounded-lg p-4 shadow-[var(--shadow-card)];
}

/* Highlighted word */
.highlighted-word {
  @apply py-0.5 px-1 rounded-sm shadow-[0_1px_2px_rgb(0_0_0_/_.08)];
}

/* Exceptional (dotted underline) */
.dictation-text span.exceptional {
  text-decoration: underline dotted theme(colors.muted-foreground);
  text-underline-offset: 1px;
}

/* Exotic words: italic */
.dictation-text span.italic {
  font-style: italic;
}

/* Tags */

@utility tag {
  @apply inline-flex items-center text-xs rounded-md px-2 py-0.5 text-primary-foreground bg-primary;
}
.tag {
  @apply tag;
}

.tag-wrapper {
  @apply inline-flex items-stretch; gap: 0;
}
.tag-wrapper .tag-with-button {
  @apply rounded-r-none;
}
.tag-wrapper .tag-button {
  @apply rounded rounded-l-none border-l border-white/20 cursor-pointer inline-flex items-center justify-center;
  padding: 0.125rem 0.375rem;
}
.tag-wrapper .tag-button:hover {
  @apply opacity-80;
}
.tag-wrapper .tag-button:focus {
  @apply outline-none ring-2 ring-ring ring-offset-1;
}
.tag-wrapper .tag-button img {
  width: 14px; height: 14px;
}

.tag.edit {
  @apply bg-primary text-primary-foreground bg-no-repeat hover:opacity-80;
}
.tag.disabled {
  @apply bg-muted text-muted-foreground cursor-default;
}
.tag.exotic {
  @apply italic;
}

/* Toasts */
.toast-container {
  @apply fixed top-4 right-4 flex flex-col gap-2;
}
.toast {
  @apply rounded-sm py-3 px-4 text-primary-foreground shadow-lg opacity-95;
  animation: fadein 0.5s;
}
.toast-title {
  @apply font-bold;
}
.toast.info    {
  @apply bg-primary;
}
.toast.success {
  @apply bg-success;
}
.toast.error   {
  @apply bg-danger;
}
.toast.warning {
  @apply bg-warning text-foreground;
}

/* Analyze icon button (keep your background-image) */
button.analyze {
  @apply pointer-events-auto; background-image: url('../icons/chart.svg');
}

/* Keyframes */
@keyframes fadein {
  from { opacity: 0; transform: translateY(-10px); }
  to   { opacity: 0.95; transform: translateY(0); }
}
